---
layout: post
title: "27. Iterable"
date: 2025-04-06
authors: ["Jay Tak"]
categories: ["Development", "Javascript"]
description: ë‹¤ì–‘í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ê³µí†µëœ ë°˜ë³µ ë°©ì‹ìœ¼ë¡œ ìˆœíšŒí•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” í”„ë¡œí† ì½œ
thumbnail: "/assets/images/gen/blog/javascript.webp"
comments: false
subscribe: false
---

---

## 1. Iterable & Iterate

### 1.1 ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œ(Iterable protocol)

**ì •ì˜:** ê°ì²´ê°€ `Symbol.iterator()` ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ë”°ë¦„

**ëª©ì :** ê°ì²´ê°€ ë°˜ë³µ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œ(ì¦‰, ìˆœíšŒëŒ€ìƒì´ ë˜ê¸° ìœ„í•´ì„œ)

**ë°˜í™˜ê°’:** `Symbol.iterator()`ë¥¼ í˜¸ì¶œí•˜ë©´ ì´í„°ë ˆì´í„° ê°ì²´ë¥¼ ë°˜í™˜í•´ì•¼ í•¨

**ì‚¬ìš©ì²˜:** `for...of`, ìŠ¤í”„ë ˆë“œ ë¬¸ë²•(`...`), ë°°ì—´ êµ¬ì¡° ë¶„í•´ ë“±ì—ì„œ ì‚¬ìš©ê°€ëŠ¥

**ì˜ˆì‹œê°ì²´:** Array, String, Set, Map, ì‚¬ìš©ì ì •ì˜ ì´í„°ëŸ¬ë¸” ë“±

```js
const iterable = {
  [Symbol.iterator]() {
    return {
      next() {
        return { value: 1, done: true };
      },
    };
  },
};
```

ex)

```js
const isIterable = v => !== null && typeof v[Symbol.iterator] === 'function';

// ë°°ì—´, ë¬¸ìì—´, map, set ë“±ì€ ì´í„°ëŸ¬ë¸”ì´ë‹¤.
isIterable([]);					// true
isIterable('');					// true
isIterable(new Map());	// true
isIterable(new Set());	// true
isIterable({});					// false

// ì˜ˆë¥¼ ë“¤ì–´, ë°°ì—´ì€ Array.prototypeì˜ Symbol.iterator ë©”ì„œë“œë¥¼ ìƒì†ë°›ëŠ” ì´í„°ëŸ¬ë¸”ì´ë‹¤. ì´í„°ëŸ¬ë¸”ì€ for...of ë¬¸ìœ¼ë¡œ ìˆœíšŒí•  ìˆ˜ ìˆìœ¼ë©°, ìŠ¤í”„ë ˆë“œ ë¬¸ë²•ê³¼ ë°°ì—´ ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ í• ë‹¹ì˜ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

const array = [1, 2, 3]

// ë°°ì—´ì€ Array.prototyeì˜ Symbol.iterator ë©”ì„œë“œë¥¼ ìƒì†ë°›ì€ ì´í„°ëŸ¬ë¸”ì´ë‹¤.
console.log(Symbol.itearble in array); // true

// âœ… ì´í„°ëŸ¬ë¸”ì¸ ë°°ì—´ì€ for...of ë¬¸ìœ¼ë¡œ ìˆœíšŒ ê°€ëŠ¥í•˜ë‹¤.
for(const item of array) {
  console.log(item);
}

// âœ… ì´í„°ëŸ¬ë¸”ì¸ ë°°ì—´ì€ ìŠ¤í”„ë ˆë“œ ë¬¸ë²•ì˜ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
console.log([...array]); // [1, 2, 3]

```

<br>

### 1.2 ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ(Iterator protocol)

**ì •ì˜:** ê°ì²´ê°€ `next()` ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆê³ , í˜¸ì¶œì‹œ `{value, done}` ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©´ ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œì„ ë”°ë¦„

**ëª©ì :** ì´í„°ëŸ¬ë¸”ì—ì„œ ì‹¤ì œ ê°’ì„ í•˜ë‚˜ì”© êº¼ë‚´ëŠ” ì—­í•  (ë°˜ë³µì˜ í¬ì¸í„°)

**ë°˜í™˜ê°’:** `next()`ëŠ” í•­ìƒ `{value: any, done: boolean}` í˜•ì‹ì˜ ê°ì²´ë¥¼ ë°˜í™˜í•´ì•¼ í•¨

**ì‚¬ìš©ì²˜:** `for...of`ë“±ì—ì„œ ë‚´ë¶€ì ìœ¼ë¡œ ìë™ í˜¸ì¶œë¨

**ì˜ˆì‹œê°ì²´:** `iterable[Symbol.iterator()]`ê°€ ê°€ë³€í•œ ê°ì²´ê°€ ëŒ€ë¶€ë¶„ í•´ë‹¹ë¨

```js
const iterable = {
  next() {
    return { value: 1, done: false };
  },
};
```

| ë¹„êµí•­ëª©       | ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œ                         | ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ                     |
| -------------- | ----------------------------------------- | --------------------------------------- |
| ê¸°ì¤€ ë©”ì„œë“œ    | `Symbol.iterator()`                       | `next()`                                |
| ì—­í•            | "ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´"                        | "ë°˜ë³µì˜ ì§„í–‰ ìƒíƒœ"                      |
| ë°˜í™˜í•˜ëŠ” ê²ƒ    | ì´í„°ë ˆì´í„° ê°ì²´                           | `{value, done}` ê°ì²´                    |
| ëˆ„ê°€ í˜¸ì¶œ?     | `for...of`ê°™ì€ ë°˜ë³µ êµ¬ë¬¸ì´ í˜¸ì¶œ           | ë°˜ë³µ êµ¬ë¬¸ ë‚´ë¶€ì—ì„œ ìë™ í˜¸ì¶œ            |
| ì‚¬ìš©ì ì •ì˜ ì‹œ | ë°˜ë³µ ëŒ€ìƒ ê°ì²´ì˜ `Symbol.iterator()` êµ¬í˜„ | ë°˜í™˜ë˜ëŠ” ì´í„°ë ˆì´í„° ê°ì²´ì˜ `next()`êµ¬í˜„ |

ex)

```js
// ë°°ì—´ì€ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ì¤€ìˆ˜í•œ ì´í„°ëŸ¬ë¸”ì´ë‹¤.
const array = [1, 2, 3];

// Symbol.iterable ë©”ì„œë“œëŠ” ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.
const iterable = array[Symbol.iterator]();

// Symbol.iterator ë©”ì„œë“œê°€ ë°˜í™˜í•œ ì´í„°ë ˆì´í„°ëŠ” next ë©”ì„œë“œë¥¼ ê°–ëŠ”ë‹¤.
console.log("next" in iterable); // true

console.log(iterable.next()); // {value: 1, done: false}
console.log(iterable.next()); // {value: 2, done: false}
console.log(iterable.next()); // {value: 3, done: false}
console.log(iterable.next()); // {value: 4, done: true}
```

<br>

<hr style="border: 1px dashed #ccc;">

## 2. `for...of` vs `for...in` ë¬´ìŠ¨ ì°¨ì´ê°€ ìˆëŠ”ê°€

<span style="color:#e74c3c">`for...in`ì€ ë‹¨ì§€ **í‚¤(key)ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¬¸ë²•**</span>

<span style="color:#3498db">`for...of`ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë°˜ë³µ êµ¬ë¬¸ ì¤‘ ìœ ì¼í•˜ê²Œ **`Symbol.iterator()`ë¥¼ ì§ì ‘í˜¸ì¶œí•´ì„œ ì´í„°ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¬¸ë²•**</span>

```js
const arr = ["a", "b", "c"];

for (const key in arr) {
  console.log("for...in:", key); // '0', '1', '2' (ë¬¸ìì—´ ì¸ë±ìŠ¤)
}

for (const value of arr) {
  console.log(`for...of`, value); // 'a', 'b', 'c' (ì‹¤ì œ ê°’)
}
```

<br>

<hr style="border: 1px dashed #ccc;">

## 3. ìœ ì‚¬ë°°ì—´ê°ì²´ vs ì´í„°ëŸ¬ë¸” vs arguments, NodeList, HTMLCollection

{% include framework/shortcodes/figure.html src="/assets/images/gen/content/post_27/iterable_compare.webp" title="iterable_compare table" caption="Jay Tak" alt="Photo of iterable compare" link="" target="" %}

### 3.1 ìœ ì‚¬ë°°ì—´ê°ì²´(Array-like Object)

**ì¡°ê±´:**

- `length` ì†ì„± ìˆìŒ
- ìˆ«ì ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼ ê°€ëŠ¥(ì˜ˆ: `obj[0]`)
- í•˜ì§€ë§Œ `Symbol.iterator()`ê°€ ì—†ìœ¼ë©´ `for...of`ë¶ˆê°€

```js
const arrayLike = {0: 'a', 1: 'b', length: 2},
console.log(arrayLike[0]); // 'a'
```

- ìœ ì‚¬ë°°ì—´ê°ì²´ëŠ” `Symbol.iterator()`ê°€ ìˆì„ìˆ˜ë„ ìˆê³ , ì—†ì„ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```js
// 1. Symbol.iteratorê°€ ì—†ëŠ” ìœ ì‚¬ë°°ì—´ê°ì²´ (ì´í„°ëŸ¬ë¸”x)
const notIterable = {
  0: 'a',
  1: 'b',
  length: 2
};

console.log(notIterable[0]);       // 'a' âœ…
console.log(notIterable.length);   // 2 âœ…

for (const item of notIterable) {
  // âŒ TypeError: notIterable is not iterable
}

---------------------------------------------------------------------------------------------

// 2. Symbol.iteratorê°€ ìˆëŠ” ìœ ì‚¬ë°°ì—´ê°ì²´ (ì´í„°ëŸ¬ë¸”o)
const iterableArrayLike = {
  0: 'x',
  1: 'y',
  length: 2,
  [Symbol.iterator]() {
    let i = 0;
    return {
      next: () => {
        return i < this.length
          ? { value: this[i++], done: false }
          : { done: true };
      }
    };
  }
};

console.log([...iterableArrayLike]);  // âœ… ['x', 'y']

```

<br>

### 3.2 ì´í„°ëŸ¬ë¸” ê°ì²´(Iterable Object)

**ì¡°ê±´:**

- `Symbol.iterator()`ë©”ì„œë“œê°€ ìˆìŒ
- `for...of`, ì „ê°œ ì—°ì‚°ì(`...`), êµ¬ì¡° ë¶„í•´ í• ë‹¹ ë“±ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

```js
const iterable = {
  [Symbol.iterabor]() {
    let i = 0;
    return {
      next() {
        return i < 3 ? { value: i++, done: false } : { done: true };
      },
    };
  },
};
```

<br>

### 3.3 arguments

```js
function example() {
  for (const arg of arguments) {
    console.log(arg); // ê°€ëŠ¥ âœ… ES6 ì´í›„ ê°€ëŠ¥
  }
}
```

<br>

### 3.4 NodeList

```js
const nodes = document.querySelectorAll("div");
for (const node of nodes) {
  console.log(node); // âœ… ê°€ëŠ¥
}
```

<br>

### 3.5 HTMLCollection

```js
const elements = document.getElementsByTagName("p");
for (const el of elements) {
  console.log(el); // âœ… ê°€ëŠ¥
}
```

<br>

<hr style="border: 1px dashed #ccc;">

## 4. ì´í„°ë ˆì´í„° vs ì´í„°ëŸ¬ë¸” vs ì´í„°ëŸ¬ë¸”ì´ì ì´í„°ë ˆì´í„°ë¥¼ ìƒì„±

### 4.1 ì´í„°ë ˆì´í„°

- ì´í„°ë ˆì´í„°ë§Œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
- `next()`ë©”ì„œë“œë§Œ ìˆê³ , `Symbol.Iterator()`ëŠ” ì—†ìŒ â†’ `for...of`ë¶ˆê°€

```js
function makeIterator() {
  let i = 0;
  return {
    next() {
      return i < 3 ? { value: i++, done: false } : { done: true };
    },
  };
}

const iter = makeIterator();

console.log(iter.next()); // { value: 0, done: false }
console.log(iter.next()); // { value: 1, done: false }
console.log(iter.next()); // { value: 2, done: false }
console.log(iter.next()); // { done: true }

// âŒ for...of ì‚¬ìš© ë¶ˆê°€
// for (const val of iter) { console.log(val); } â†’ TypeError
```

ğŸ§ Q. ì–´ë–¤ ê²½ìš°ì— ì í•©í•˜ê²Œ ì‚¬ìš©í• ê¹Œ?

**<span style="color:#3498db">ë‚´ë¶€ì ìœ¼ë¡œ ì§ì ‘ `next()`ë¥¼ í˜¸ì¶œí•´ ë°˜ë³µ ì œì–´í•˜ê³  ì‹¶ì„ë•Œ</span>**

```js
// 1.1 ìˆ˜ë™ìœ¼ë¡œ ë°˜ë³µì²˜ë¦¬ê¸° ë§Œë“¤ë•Œ
function makeIterator(max) {
  let i = 0;
  return {
    next() {
      return i < max ? { value: i++, done: false } : { done: true };
    },
  };
}

// 1.2 ìˆ˜ë™ìœ¼ë¡œ ë°˜ë³µí•˜ê¸°
const iter = makeIterator(5);
let result = iter.next();

while (!result.done) {
  console.log(result.value); // ì¶œë ¥: 0, 1, 2, 3, 4
  result = iter.next(); // ìˆ˜ë™ìœ¼ë¡œ ë‹¤ìŒ ê°’ ìš”ì²­
}
```

<br>

### 4.2 ì´í„°ëŸ¬ë¸”

- ì´í„°ëŸ¬ë¸”ë§Œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
- `Symbol.iterator()`ëŠ” ìˆì§€ë§Œ `next()`ëŠ” ë°˜í™˜ëœ ê°ì²´ë§Œ ìˆìŒ â†’ ë°˜ë³µí•  ìˆ˜ ìˆì§€ë§Œ ì§ì ‘ nextëŠ” í˜¸ì¶œëª»í•¨

```js
function makeIterable(max) {
  return {
    [Symbol.iterator]() {
      let i = 0;
      return {
        next() {
          return i < max ? { value: i++, done: false } : { done: true };
        },
      };
    },
  };
}

const iterable = makeIterable(3);

for (const val of iterable) {
  console.log(val); // 0, 1, 2
}

// âŒ iterable.next()ëŠ” ì—†ìŒ â†’ ì´í„°ë ˆì´í„°ëŠ” ë³„ë„ë¡œ êº¼ë‚´ì•¼ í•¨
// console.log(iterable.next()); â†’ Error
```

ğŸ§ Q. ì–´ë–¤ ê²½ìš°ì— ì í•©í•˜ê²Œ ì‚¬ìš©í• ê¹Œ?

**<span style="color:#3498db">`for...of`, `...`, `Array.from()`ë“± ìˆœíšŒ ê¸°ë°˜ ë¬¸ë²•ì„ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ê³  ì‹¶ì„ë•Œ</span>**

```js
// 2.1 í˜ì´ì§• API ì‹œë®¬ë ˆì´í„°
function fakeApi(page) {
  const data = {
    1: ['A': 'B'],
    2: ['C': 'D'],
    3: ['E'],
    4: [] // ë§ˆì§€ë§‰ í˜ì´ì§€
  };
	return data[page] || [];
}

// 2.2 ì´í„°ëŸ¬ë¸” í˜ì´ì§€ë„¤ì´í„°
function createPaginator(maxPages) {
  return {
    [Symbol.iterator]() {
     let currentPage = 1;
      return {
        next() {
          if (currentPage > maxPages) return {done: true};
          const data = fakeApi(currentPage++);
          return data.length ? {value: data, done: false} : {done: true};
        }
      };
    }
  };
}

for (const pageData of createPaginator(4)) {
  console.log('Page:', pageDate);
}

// ì¶œë ¥:
// Page: ['A', 'B']
// Page: ['C', 'D']
// Page: ['E']

```

<br>

### 4.3 ì´í„°ëŸ¬ë¸”ì´ì ì´í„°ë ˆì´í„°ì¸ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜

- ì´í„°ëŸ¬ë¸”ì´ì ì´í„°ë ˆì´í„°ì¸ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
- `Symbol.iterator()`ê°€ `this`ë¥¼ ë°˜í™˜ â†’ `for...of`ì™€ `next()`ë‘˜ ë‹¤ ê°€ëŠ¥
- í•˜ì§€ë§Œ í•œ ë²ˆë§Œ ìˆœíšŒ ê°€ëŠ¥(ì†Œì§„ë¨)

```js
function makeIterableIterator(max) {
  let i = 0;
  return {
    [Symbol.iterator]() {
      return this;
    },
    next() {
      return i < max ? { value: i++, done: false } : { done: true };
    },
  };
}

const iterBoth = makeIterableIterator(3);

for (const val of iterBoth) {
  console.log(val); // 0, 1, 2
}

for (const val of iterBoth) {
  console.log(val); // âŒ ì¶œë ¥ ì—†ìŒ: ì´í„°ë ˆì´í„°ëŠ” ì†Œì§„ë¨
}

// âœ… ì§ì ‘ next()ë„ í˜¸ì¶œ ê°€ëŠ¥
const iter3 = makeIterableIterator(2);
console.log(iter3.next()); // { value: 0, done: false }
console.log(iter3.next()); // { value: 1, done: false }
console.log(iter3.next()); // { done: true }
```

ğŸ§ Q. ì–´ë–¤ ê²½ìš°ì— ì í•©í•˜ê²Œ ì‚¬ìš©í• ê¹Œ?

**<span style="color:#3498db">ê°„ë‹¨í•œ ë°˜ë³µ ì‘ì—…ì„ ë§Œë“¤ê³  `for...of`, `next()`ë¥¼ ëª¨ë‘ ì§€ì›í•˜ê³  ì‹¶ì„ ë•Œ</span>**

```js
// 3.1 JSON ë°ì´í„° ì²˜ëŸ¼ í•œ ë²ˆë§Œ ì½ê³  ìˆœíšŒí•  ìˆ˜ ìˆëŠ” ìŠ¤íŠ¸ë¦¼ì„ ì´í„°ëŸ¬ë¸”ë¡œ êµ¬í˜„í•œ ì˜ˆì œ
function createOneTimeStream(dataArray) {
  let index = 0;
  return {
    [Symbol.iterator]() {
      return this; // ìê¸° ìì‹ ì´ ì´í„°ë ˆì´í„°ì´ì ì´í„°ëŸ¬ë¸”
    },
    next() {
      return index < dataArray.length
        ? { value: dataArray[index++], done: false }
        : { done: true };
    },
  };
}

const stream = createOneTimeStream(["ğŸ§Š", "ğŸ”¥", "ğŸ’§"]);

for (const item of stream) {
  console.log("ğŸšš received:", item);
}
// ğŸšš received: ğŸ§Š
// ğŸšš received: ğŸ”¥
// ğŸšš received: ğŸ’§

for (const item of stream) {
  console.log("âŒ should not appear:", item); // ì¶œë ¥ ì—†ìŒ â€“ ì´ë¯¸ ì†Œì§„ë¨
}
```

<br><br>

#### <span style="color:grey">reference: ëª¨ë˜ìë°”ìŠ¤í¬ë¦½íŠ¸ Deep Dive 34ì¥. Iterable</span>
